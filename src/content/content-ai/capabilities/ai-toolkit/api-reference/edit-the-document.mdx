---
title: Edit the document
meta:
  title: Edit the document | Tiptap Content AI
  description: Insert, stream, and patch AI-generated content in text, HTML, or JSON formats. Includes review options for user approval workflows.
  category: Content AI
---

The AI Toolkit provides methods to edit the document in different formats.

## `insertText`

Insert plain text into the editor.

### Parameters

- `content` (`string`): Text to insert
- `options?` (`InsertTextOptions`): Options for the `insertText` method
  - `position?` (`InsertPosition`): Where to insert. [See options](#insertposition-type). Default: `'selection'`
  - `reviewOptions?` ([`ReviewOptions`](/content-ai/capabilities/ai-toolkit/api-reference/review-options)): Control preview/review behavior. [See available options](/content-ai/capabilities/ai-toolkit/api-reference/review-options).

### Returns

`void`

### Example

```ts
// Insert text at the current selection and show review markers
toolkit.insertText('AI content', { position: 'selection', reviewOptions: { mode: 'review' } })
```

## `insertHtml`

Insert HTML into the editor.

### Parameters

- `content` (`string`): HTML to insert
- `options?` (`InsertHtmlOptions`): Options for the `insertHtml` method
  - `position?` (`InsertPosition`): Where to insert. [See options](#insertposition-type). Default: `'selection'`
  - `reviewOptions?` ([`ReviewOptions`](/content-ai/capabilities/ai-toolkit/api-reference/review-options)): Control preview/review behavior. [See available options](/content-ai/capabilities/ai-toolkit/api-reference/review-options).

### Returns

`void`

### Example

```ts
// Insert a paragraph after the selection
toolkit.insertHtml('<p>AI paragraph</p>', { position: 'selectionEnd' })
```

## `insertJson`

Insert ProseMirror JSON into the editor.

### Parameters

- `content` (`any`): ProseMirror JSON node or slice
- `options?` (`InsertJsonOptions`): Options for the `insertJson` method
  - `position?` (`InsertPosition`): Where to insert. [See options](#insertposition-type). Default: `'selection'`
  - `reviewOptions?` ([`ReviewOptions`](/content-ai/capabilities/ai-toolkit/api-reference/review-options)): Control preview/review behavior. [See available options](/content-ai/capabilities/ai-toolkit/api-reference/review-options).

### Returns

`void`

### Example

```ts
// Insert a paragraph node
toolkit.insertJson({ type: 'paragraph', content: [{ type: 'text', text: 'AI' }] })
```

## `streamText`

Stream plain text content into the editor in real-time.

### Parameters

- `stream` (`AsyncIterable<string | Uint8Array>`): The stream of text content. It can be any object that implements the [Async Iterable protocol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_async_iterator_and_async_iterable_protocols), such as a [generator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_generators).
- `options?` (`StreamTextOptions`): Options for the `streamText` method
  - `position?` (`InsertPosition`): Where to insert. [See options](#insertposition-type). Default: `'selection'`
  - `reviewOptions?` ([`ReviewOptions`](/content-ai/capabilities/ai-toolkit/api-reference/review-options)): Control preview/review behavior. [See available options](/content-ai/capabilities/ai-toolkit/api-reference/review-options).
  - `checkChunkForError?` (`(status: { chunk: string; content: string; range: Range }) => boolean`): A function to check if the chunk contains an error. Returns `true` if the chunk has an error, `false` otherwise. If `true`, the stream will be stopped and a `StreamingChunkCheckFailedError` will be thrown.
  - `onError?` (`(event: { error: unknown; chunk: string; content: string; range: Range }) => void`): A function to handle errors that occur during streaming.
  - `onChunkInserted?` (`(event: { chunk: string; content: string; range: Range }) => void`): A function to handle when a chunk is streamed. Called after the chunk is inserted into the editor.

### Returns

`Promise<void>`: A promise that resolves when the stream is complete.

### Example

```ts
const response = await fetch('/api/generate-text')
// The API endpoint returns a stream of text content
const stream = response.body

toolkit.streamText(stream)
```

## `streamHtml`

Stream HTML content into the editor in real-time.

### Parameters

- `stream` (`AsyncIterable<string | Uint8Array> | ReadableStream<string | Uint8Array>`): The stream of HTML content. It can be any object that implements the [Async Iterable protocol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_async_iterator_and_async_iterable_protocols), such as a [ReadableStream](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream) or a [generator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_generators).
- `options?` (`StreamHtmlOptions`): Options for the `streamHtml` method
  - `position?` (`InsertPosition`): Where to insert. [See options](#insertposition-type). Default: `'selection'`
  - `reviewOptions?` ([`ReviewOptions`](/content-ai/capabilities/ai-toolkit/api-reference/review-options)): Control preview/review behavior. [See available options](/content-ai/capabilities/ai-toolkit/api-reference/review-options).
  - `checkChunkForError?` (`(status: { chunk: string; content: string; range: Range }) => boolean`): A function to check if the chunk contains an error. Returns `true` if the chunk has an error, `false` otherwise. If `true`, the stream will be stopped and a `StreamingChunkCheckFailedError` will be thrown.
  - `onError?` (`(event: { error: unknown; chunk: string; content: string; range: Range }) => void`): A function to handle errors that occur during streaming.
  - `onChunkInserted?` (`(event: { chunk: string; content: string; range: Range }) => void`): A function to handle when a chunk is streamed. Called after the chunk is inserted into the editor.

### Returns

`Promise<void>`: A promise that resolves when the stream is complete.

### Example

```ts
const response = await fetch('/api/generate-html')
// The API endpoint returns a stream of HTML content
const stream = response.body
toolkit.streamHtml(stream)
```

## `applyHtmlPatch`

Apply context-aware HTML diffs to a chunk or the whole document.

### Parameters

- `operations` (`PatchOperation[]`): A list of patch operations.
- `options?` (`ApplyHtmlPatchOptions`): Options for the `applyHtmlPatch` method
  - `chunkIndex?` (`number`): Target chunk index. Default: `0`
  - `chunkSize?` (`number`): The maximum size of a string that can be passed as input to the AI model. Prevents the AI from reading too much content at once so that the context window of the AI model is not exceeded. Default: `32000`
  - `reviewOptions?` ([`ReviewOptions`](/content-ai/capabilities/ai-toolkit/api-reference/review-options)): Control preview/review behavior. [See available options](/content-ai/capabilities/ai-toolkit/api-reference/review-options).

#### `PatchOperation` (type)

A `PatchOperation` can be one of two types:

`JumpOperation`: A navigation operation that moves the cursor to a specific context in the document.

- `type` (`'jump'`): The operation type identifier
- `context` (`string`): The context string to search for and position the cursor after

`ReplaceOperation`: A replace operation that deletes and inserts text at the current cursor position.

Replace operations perform the actual content modifications by removing specified text and replacing it with new text. The delete text must be found at the current cursor position for the operation to succeed.

- `type` (`'replace'`): The operation type identifier
- `delete` (`string`): The exact text to delete from the document (can be empty for pure insertions)
- `insert` (`string`): The text to insert in place of the deleted text

### Returns (`ApplyHtmlPatchResult`)

- `docChanged` (`boolean`): Whether the document was modified
- `error` (`ApplyPatchError | null`): Error if the diff application failed because not all diffs could be applied, null if successful

The method can edit the document but return an error at the same time. This happens when some operations are applied but some fail.

#### `ApplyPatchError` (type)

Error thrown when applying a Universal Patch Format operation fails. This error provides comprehensive context about the failure, including which operation failed, what operations succeeded before it, and the current state of the content.

- `operationIndex` (`number`): The zero-based index of the operation that failed
- `previousOperations` (`PatchOperation[]`): Array of operations that were successfully applied before the failure
- `operation` (`PatchOperation`): The operation that failed to apply
- `contentAfterCursor` (`string`): The content after the current cursor position when the error occurred

### Example

```ts
// Replace "fine" with emphasized "great" in the first chunk
toolkit.applyHtmlPatch([{ type: 'replace', delete: 'fine', insert: '<em>great</em>' }])
```

---

## `InsertPosition` (type)

The position where the content will be inserted. It can be one of the following values:

- `Range`: A range of the document
- `number`: A position in the document
- `'selection'`: Replace the current selection with the new content
- `'selectionStart'`: The start of the current selection
- `'selectionEnd'`: The end of the current selection
- `'document'`: Replace the entire document with the new content
- `'documentStart'`: The start of the document
- `'documentEnd'`: The end of the document
