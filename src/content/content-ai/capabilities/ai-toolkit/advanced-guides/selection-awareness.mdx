---
title: Selection awareness
meta:
  title: Selection awareness | Tiptap Content AI
  description: Make the AI aware of the selected content in the editor.
  category: Content AI
---

import { Callout } from '@/components/ui/Callout'
import { CodeDemo } from '@/components/CodeDemo'
import { Requirements, RequirementItem } from '@/components/Requirements'
import { EnterpriseCalloutAuto } from '@/components/EnterpriseCalloutAuto'

<EnterpriseCalloutAuto variant="ai-toolkit" renderMode="sidebar" />
<Requirements>
  <RequirementItem label="1. Request access">
    <a href="https://tiptap-suite.notion.site/27901ffa3ebc803197d8e4857e5ae394?pvs=105">
      Share your use case
    </a>
    to be considered for early access to Tiptap AI Toolkit.
  </RequirementItem>
  <RequirementItem label="2. Access the private registry">
    The AI Toolkit extension is published in Tiptap&apos;s private npm registry. Authenticate to
    Tiptap&apos;s private npm registry by following the{' '}
    <a href="/guides/pro-extensions">setup guide</a>.
  </RequirementItem>
  <RequirementItem label="3. Install the extension">
    Install the extension from the private registry using npm or your preferred package manager.
  </RequirementItem>
</Requirements>

Configure the AI so that it can read and edit the selected content in the editor.

<Callout title="Continuation from the AI agent chatbot guide" variant="info">
  This guide continues the [AI agent chatbot
  guide](/content-ai/capabilities/ai-toolkit/guides/ai-agent-chatbot). Read it first.
</Callout>

<CodeDemo path="" isScrollable src="https://ai-toolkit-demos.vercel.app/selection-awareness" />

See the [source code on GitHub](https://github.com/ueberdosis/ai-toolkit-demos).

## The `readSelection` tool

The `readSelection` tool allows the AI agent to read the selected content in the editor.

It is included by default in the list of tool definitions that are passed to the AI model.

```ts
// Server-side code
import { toolDefinitions } from '@tiptap-pro/ai-toolkit-ai-sdk'

const definitions = toolDefinitions({
  // Enable the readSelection tool.
  // The readSelection tool is enabled by default.
  readSelection: true,
})
```

The tool can then be executed in the client-side using the `executeTool` method. It does not require any parameters.

```ts
// Client-side code
const toolkit = getAiToolkit(editor)
const result = await toolkit.executeTool({
  toolName: 'readSelection',
})
```

The output of the tool contains the following information:

- The content of the selection
- The position of the selection

This information lets the AI know what content is selected, and where it is located in the document, so that it can edit it later.

If reading and writing the selection is not a requirement of your app, you can disable the tool by passing `false` to the `readSelection` option in the tool definitions.

```ts
// Server-side code
import { toolDefinitions } from '@tiptap-pro/ai-toolkit-ai-sdk'

const definitions = toolDefinitions({
  // Disable the readSelection tool.
  readSelection: false,
})
```

## Preserving the selection

Sometimes, while the AI is doing its work, the user changes the selection in the editor. This confuses the AI: when it has finished deciding what to do, it does not know that the selection has changed, so it reads the wrong selection content.

To avoid this, you can store the selection when the user sends a message to the AI, so that it does not change while the AI is thinking (even if the user changes it afterwards).

First, call the `setActiveSelection` method with the current selection when the user sends a message to the AI.

```ts
const toolkit = getAiToolkit(editor)
// Call this method just before the AI starts working.
toolkit.setActiveSelection(editor.state.selection)
```

Then, when the AI finishes its work, call the `setActiveSelection` method with `null` to unset the active selection.

```ts
toolkit.setActiveSelection(null)
```

You can also set the active selection to any position in the document.

```ts
toolkit.setActiveSelection({ from: 10, to: 20 })
```

## End result

With additional CSS styles, the result is a simple but polished AI chatbot that can edit the selected content:

<CodeDemo path="" isScrollable src="https://ai-toolkit-demos.vercel.app/selection-awareness" />

See the [source code on GitHub](https://github.com/ueberdosis/ai-toolkit-demos).

## Next steps

- Learn more about the `getActiveSelection` and `setActiveSelection` methods in the [API reference](/content-ai/capabilities/ai-toolkit/primitives/execute-tool#setactiveselection).
