---
title: Schema awareness
meta:
  title: Schema awareness | Tiptap Content AI
  description: Provide schema awareness to AI models so they understand nodes, marks, and attributes on the server.
  category: Content AI
---

import { Callout } from '@/components/ui/Callout'

A Tiptap [schema](/editor/core-concepts/schema) describes the elements the document can (and cannot) contain. The Server AI Toolkit uses **JSON schema awareness** to help AI models understand the document structure.

<Callout title="Why schema awareness?" variant="default">
  Without schema awareness, the AI model might generate content that the Tiptap editor does not
  support. For example, it might generate a table in a document that does not support tables. With
  schema awareness enabled, the AI model will know that table nodes are not supported and will
  refuse to generate them.
</Callout>

## Guide: give schema awareness to your AI model

Integrate the schema awareness feature with a server-side AI agent.

### Step 1: get the schema awareness data (client-side)

Get the schema awareness data from the Server AI Toolkit on the client-side. This data contains the serialized schema and custom node information.

```tsx
// Client-side
import { getSchemaAwarenessData } from '@tiptap-pro/server-ai-toolkit'

// Create a new Tiptap Editor instance
const editor = new Editor({
  extensions: [StarterKit],
})

// Get schema awareness data
const schemaAwarenessData = getSchemaAwarenessData(editor)
```

### Step 2: send to server

Send the schema awareness data to your server endpoint when making API calls.

```tsx
// Client-side
const { messages, sendMessage } = useChat({
  transport: new DefaultChatTransport({
    api: '/api/server-ai-toolkit',
    body: () => ({
      schemaAwarenessData,
    }),
  }),
})
```

### Step 3: create server toolkit with schema awareness

On the server, create a Server AI Toolkit instance with the schema awareness data:

```typescript
// Server-side API endpoint
import { getServerAiToolkit } from '@tiptap-pro/server-ai-toolkit'

export async function POST(req: Request) {
  const { messages, schemaAwarenessData } = await req.json()

  const toolkit = getServerAiToolkit({
    schemaAwarenessData,
    storage,
  })

  // ... use the toolkit
}
```

### Step 4: add schema awareness to system prompt

Use `getSchemaAwarenessPrompt()` to get a string describing the document's schema, optimized for AI models.

```typescript
import { streamText } from 'ai'
import { openai } from '@ai-sdk/openai'

const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  storage,
  tools: serverToolDefinitions(),
})

const result = streamText({
  model: openai('gpt-5.1'),
  system: `You are an assistant that can edit rich text documents.

${toolkit.getSchemaAwarenessPrompt()}`,
  messages,
  tools: toolkit.getTools(),
})
```

The schema awareness prompt is automatically added to the system prompt, helping the AI model understand what nodes and marks are available in the document.

## Custom Nodes

If your document contains [custom Nodes and Marks](/editor/extensions/custom-extensions), add the `addJsonSchemaAwareness` option to the extension configuration on the client-side.

```typescript
// Client-side
import { Node } from '@tiptap/core'

const CustomExtension = Node.configure({
  name: 'alert',

  addJsonSchemaAwareness() {
    return {
      name: 'Alert Box',
      description: `A highlighted box used to display important information, warnings, or tips to the user.
It can have inline content inside like text and formatting tags.`,
      attributes: {
        type: z.enum(['info', 'warning', 'error', 'success']).describe('The type of alert'),
      },
    }
  },

  // ... Other extension configuration options
})
```

The schema awareness data will include information about this custom node, and the AI model will be able to generate it.

<Callout title="What about official Tiptap extensions?" variant="info">
  Schema awareness for official Tiptap extensions is automatically supported by the AI Toolkit. They
  do not need to be configured. You can still override the default schema awareness information for
  official Tiptap extensions by extending the extension and adding the `addJsonSchemaAwareness`
  option.
</Callout>

## API Reference

### `getSchemaAwarenessData`

Returns schema awareness data including a serialized schema and custom node information.

This function has to be called on an environment that has access to a Tiptap editor instance.
You can call it on the client-side and sent the schema awareness data over the network. Alternatively, you can create an instance of the Tiptap Editor on the server-side and call the `getSchemaAwarenessData` function on it.

#### Parameters (`GetSchemaAwarenessDataOptions`)

- `editor` (`Editor`): The Tiptap editor instance
- `options?` (`GetSchemaAwarenessDataOptions`): Configuration options
  - `customNodes?` (`JsonItem[]`): Custom schema awareness items to include in addition to the default ones. Default: `[]`

#### Returns (`SchemaAwarenessData`)

An object describing the schema. This object can be passed to the `schemaAwarenessData` parameter of the `getServerAiToolkit` function.

The `SchemaAwarenessData` object is serializable, meaning that it can be encoded as a JSON string and sent over the network or stored in a database.

- `serializedSchema` (`SerializedSchema`): The serialized schema of the Tiptap editor
- `items` (`SerializedJsonItem[]`): The merged custom nodes with JSON schema attributes

#### Example

```typescript
// Client-side
import { getSchemaAwarenessData } from '@tiptap-pro/server-ai-toolkit'

const schemaAwarenessData = getSchemaAwarenessData(editor)

// Send to server
fetch('/api/server-ai-toolkit', {
  method: 'POST',
  body: JSON.stringify({ schemaAwarenessData }),
})
```

### `getSchemaAwarenessPrompt`

Returns a string describing the document's schema. This string should be added to the system prompt that is sent to the AI model.

This method is called on the server-side using the Server AI Toolkit.

#### Parameters

None

#### Returns

`string`: Human-readable schema awareness text suitable for system prompts

#### Example

```typescript
// Server-side
const toolkit = getServerAiToolkit({
  schemaAwarenessData,
})

const schemaPrompt = toolkit.getSchemaAwarenessPrompt()

// Add to system prompt
const systemPrompt = `You are an assistant that can edit rich text documents.

${schemaPrompt}`
```

### `setSchemaAwarenessData` (Server AI Toolkit instance method)

Set the schema awareness data to a new value. This is useful if you have a multi-document setup where each document has a different schema.

After calling this method, the Server AI Toolkit will use the new schema. The Server AI Toolkit's current document will also be reset to an empty document, because the document is no longer valid for the new schema.

#### Parameters

- `schemaAwarenessData` (`SchemaAwarenessData`): The schema awareness data to set

#### Returns

`void`

#### Example

```typescript
toolkit.setSchemaAwarenessData(schemaAwarenessData)
```

### `addJsonSchemaAwareness` (extension configuration option)

Add schema awareness information about a custom Node or Mark. This option is used to configure custom nodes and marks for the AI model to know about them.

This configuration option is available for [custom Node and Mark extensions](/editor/extensions/custom-extensions/create-new/node) on the client-side.

#### Parameters (`JsonItem`)

- `name` (`string`): The human-readable name of the element
- `description?` (`string | null`): Explanation of what the element is and how it is used
- `attributes?` (`Record<string, ZodType>`): Zod schemas for the node's attributes

#### Example

```typescript
// Client-side
import { Node } from '@tiptap/core'
import { z } from 'zod'

const AlertNode = Node.create({
  name: 'alert',

  addJsonSchemaAwareness() {
    return {
      name: 'Alert Box',
      description: 'A highlighted box for important information',
      attributes: {
        type: z.enum(['info', 'warning', 'error', 'success']).describe('The alert type'),
        dismissible: z.boolean().optional().describe('Whether the alert can be dismissed'),
      },
    }
  },

  // ... other configuration
})
```
