---
title: Events
meta:
  title: Events | Tiptap Content AI
  description: Use callbacks to monitor and react to tool execution events in the Server AI Toolkit.
  category: Content AI
---

The Server AI Toolkit provides callbacks that are called before and after tool execution. Use these callbacks to monitor tool usage, log execution details, or perform side effects based on tool execution results.

## `onBeforeExecuteTool`

Callback function that is called before executing a tool. This callback receives the tool execution options and can be used to perform actions such as logging, validation, or modifying the input before the tool is executed.

### Parameters

- `options` (`ExecuteToolOptions`): The options for the tool execution
  - `toolName` (`string`): The name of the tool to execute
  - `input` (`unknown`): Arguments to pass to the tool

### Returns

`void | Promise<void>`

### Example

```typescript
import { getServerAiToolkit } from '@tiptap-pro/server-ai-toolkit'

const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  onBeforeExecuteTool: async (options) => {
    console.log(`Executing tool: ${options.toolName}`)
    console.log('Input:', options.input)

    // You can perform validation or other checks here
    if (options.toolName === 'tiptapEdit') {
      // Validate edit operations before execution
      console.log('Validating edit operations...')
    }
  },
})
```

## `onExecuteTool`

Callback function that is called after executing a tool. This callback receives both the original options and the result of the tool execution. It can be used for logging, monitoring, or performing side effects based on the execution result.

### Parameters

- `options` (`ExecuteToolOptions`): The options that were used for the tool execution
  - `toolName` (`string`): The name of the tool that was executed
  - `input` (`unknown`): Arguments that were passed to the tool
- `result` (`ExecuteToolResult`): The result of the tool execution
  - `unknownTool` (`boolean`): Whether the tool is not recognized by the AI Toolkit
  - `output` (`string`): Response message from the tool execution, to be read by the AI agent
  - `structuredOutput` (`ExecuteTiptapEditOutput | ExecuteTiptapReadOutput | null`): Response message from the tool execution, in a typed structured format
  - `hasError` (`boolean`): Whether there was an error during execution
  - `docChanged` (`boolean`): Whether the tool call modifies the document

### Returns

`void | Promise<void>`

### Example

```typescript
import { getServerAiToolkit } from '@tiptap-pro/server-ai-toolkit'

const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  onExecuteTool: async (options, result) => {
    console.log(`Tool execution completed: ${options.toolName}`)
    console.log('Result:', result)

    if (result.hasError) {
      console.error('Tool execution failed:', result.output)
      // Send error to monitoring service
      await sendToMonitoringService({
        toolName: options.toolName,
        error: result.output,
      })
    }

    if (result.docChanged) {
      console.log('Document was modified by the tool')
      // Trigger document save or update
      await triggerDocumentUpdate()
    }
  },
})
```

## Using Both Callbacks

You can use both callbacks together to track the complete lifecycle of tool execution:

```typescript
import { getServerAiToolkit } from '@tiptap-pro/server-ai-toolkit'

const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  onBeforeExecuteTool: async (options) => {
    const startTime = Date.now()
    // Store start time for performance tracking
    executionContext.set('startTime', startTime)
    console.log(`[${startTime}] Starting tool execution: ${options.toolName}`)
  },
  onExecuteTool: async (options, result) => {
    const startTime = executionContext.get('startTime')
    const duration = Date.now() - startTime
    console.log(`[${Date.now()}] Tool execution completed: ${options.toolName} (${duration}ms)`)

    // Log performance metrics
    await logPerformanceMetrics({
      toolName: options.toolName,
      duration,
      success: !result.hasError,
      docChanged: result.docChanged,
    })
  },
})
```

## Use Cases

### Logging and Monitoring

Track all tool executions for debugging and monitoring:

```typescript
const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  onBeforeExecuteTool: (options) => {
    logger.info('Tool execution started', {
      toolName: options.toolName,
      timestamp: new Date().toISOString(),
    })
  },
  onExecuteTool: (options, result) => {
    logger.info('Tool execution completed', {
      toolName: options.toolName,
      success: !result.hasError,
      docChanged: result.docChanged,
      timestamp: new Date().toISOString(),
    })
  },
})
```

### Error Handling and Reporting

Automatically report errors to your error tracking service:

```typescript
const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  onExecuteTool: async (options, result) => {
    if (result.hasError) {
      await errorTrackingService.captureException({
        message: `Tool execution failed: ${options.toolName}`,
        error: result.output,
        context: {
          toolName: options.toolName,
          input: options.input,
        },
      })
    }
  },
})
```

### Document Change Notifications

Notify other systems when the document is modified:

```typescript
const toolkit = getServerAiToolkit({
  schemaAwarenessData,
  onExecuteTool: async (options, result) => {
    if (result.docChanged) {
      // Notify other services that the document has changed
      await notifyDocumentChange({
        documentId: toolkit.state.document,
        toolName: options.toolName,
      })
    }
  },
})
```
