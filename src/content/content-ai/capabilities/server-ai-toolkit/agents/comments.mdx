---
title: Server comments
meta:
  title: Server comments | Tiptap Server AI Toolkit
  description: Enable server-side AI agents to read and edit comments in Tiptap documents using the Server AI Toolkit.
  category: Content AI
sidebars:
  hideSecondary: true
---

import { Callout } from '@/components/ui/Callout'
import { CodeDemo } from '@/components/CodeDemo'

Give your AI agents the ability to read, write and edit comments in your document, fully server-side.

<CodeDemo isLarge path="" isScrollable src="https://ai-toolkit-demos.vercel.app/server-comments" />

See the [source code on GitHub](https://github.com/ueberdosis/ai-toolkit-demos).

<Callout title="Experimental feature" variant="warning">
  This feature is experimental and the API will change in future releases.
</Callout>

<Callout title="Continuation from the AI agent chatbot guide" variant="info">
  This guide continues the [AI agent chatbot
  guide](/content-ai/capabilities/server-ai-toolkit/agents/ai-agent-chatbot). Read it first.
</Callout>

## Enable comment tools

To enable comment tools, pass the `getThreads` and `editThreads` options when fetching tool definitions from the Server AI Toolkit API.

```ts
const response = await fetch(`${apiBaseUrl}/toolkit/tools`, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${jwtToken}`,
    'X-App-Id': appId,
  },
  body: JSON.stringify({
    schemaAwarenessData,
    tools: {
      // Disable tiptap edit tool so that the AI can not edit the document,
      // only add comments
      tiptapEdit: false,
      // Enable comment tools
      getThreads: true,
      editThreads: true,
    },
  }),
})
```

## Execute comment tools

Comment tools require **document mode** because threads and comments are stored on the Tiptap Document Server. In document mode, you don't need to pass the `document` field â€” the server fetches and saves it automatically.

### JWT requirements

Your JWT must include Document Server credentials as claims:

- `experimental_document_app_id` (`string`): The Tiptap Cloud app ID for the Document Server
- `experimental_document_secret` (`string`): The admin API secret for the Document Server

### Request body

Include `experimental_documentOptions` in the request body:

- `documentId` (`string`, required): The ID of the document
- `userId` (`string`, optional): The ID of the user creating comments. If omitted, comments are created without user attribution.

Optionally include `experimental_commentsOptions` for metadata:

- `threadData` (`Record<string, any>`, optional): Metadata attached to new threads when they are created by the `editThreads` tool.
- `commentData` (`Record<string, any>`, optional): Metadata attached to new comments when they are created by the `editThreads` tool.

```ts
// JWT must include Document Server credentials
import jwt from 'jsonwebtoken'

const jwtToken = jwt.sign(
  {
    // Document Server credentials (required for comment tools)
    experimental_document_app_id: 'your-document-app-id',
    experimental_document_secret: 'your-document-api-secret',
  },
  TIPTAP_CLOUD_AI_SECRET,
  { expiresIn: '1h' },
)

const result = await fetch(`${apiBaseUrl}/toolkit/execute-tool`, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${jwtToken}`,
    'X-App-Id': appId,
  },
  body: JSON.stringify({
    toolName: 'editThreads',
    input: {},
    schemaAwarenessData,
    // Required for comment tools (document mode)
    experimental_documentOptions: {
      documentId: '123',
      userId: 'ai-assistant',
    },
    // Optional metadata
    experimental_commentsOptions: {
      threadData: { source: 'ai' },
      commentData: { source: 'ai' },
    },
  }),
})
```

## End result

The result is a simple but polished AI chatbot application:

<CodeDemo isLarge path="" isScrollable src="https://ai-toolkit-demos.vercel.app/server-comments" />

See the [source code on GitHub](https://github.com/ueberdosis/ai-toolkit-demos).

## Next steps

- Learn about all available [tool definitions](/content-ai/capabilities/server-ai-toolkit/agents/tools)
- Explore the [REST API reference](/content-ai/capabilities/server-ai-toolkit/api-reference/rest-api)
